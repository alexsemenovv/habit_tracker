import logging

from aiogram import Router
from aiogram.filters import CommandStart
from aiogram.types import Message

from backend.dao.dao import UserDAO

logging.basicConfig(level=logging.DEBUG,
                    format="%(asctime)s - [%(levelname)s] -  %(name)s - (%(filename)s).%(funcName)s(%(lineno)d) - %(message)s")
logger = logging.getLogger(__name__)

start_router = Router()


@start_router.message(CommandStart())
async def cmd_start(message: Message) -> None:
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã —Å—Ç–∞—Ä—Ç"""
    logger.info("–ù–∞–∂–∞—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ /start")

    # TODO –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–≤–µ—Ä–Ω–æ
    # user = await UserDAO.find_one_or_none(telegram_id=message.from_user.id)

    # if not user:
    #     logger.info("USER –Ω–µ –Ω–∞–π–¥–µ–Ω")
    #     await UserDAO.add(
    #         telegram_id=message.from_user.id,
    #         first_name=message.from_user.first_name,
    #         last_name=message.from_user.last_name,
    #         username=message.from_user.username
    #     )

    await message.answer(
        "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é —Ç–µ–±—è!üëã\n"
        "–≠—Ç–æ –±–æ—Ç-—Ç—Ä–µ–∫–µ—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–µ–∫üëÅ\n"
        "–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ —É–º–µ–µ—Ç —ç—Ç–æ—Ç –±–æ—Ç –∂–º–∏ /helpüëà\n"
        "–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥, –∂–º–∏ /commands"
    )
